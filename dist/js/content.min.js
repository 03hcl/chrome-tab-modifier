var Tab=function(e,t,n){var l,r,i,u,o=null,c=null,a=null,d=null,g=null,m=null;for(var f in n)if(-1!==e.indexOf(f)){o=f,c=n[f].title||null,a=n[f].icon||null,d=n[f].pinned||null,g=n[f]["protected"]||null,m=n[f].unique||null,url_matcher=n[f].url_matcher||null;break}return l=function(){if(null!==c&&(c=-1!==c.indexOf("{title}")?c.replace("{title}",t):c),null!==url_matcher)for(var n=e.match(url_matcher)||[],l=1;l<n.length;l++)c=c.replace("$"+l,n[l]||"")},l(),getMatch=function(){return o},r=function(){return c},i=function(){return a},u=function(){return d},getProtected=function(){return g},getUnique=function(){return m},{getMatch:getMatch,getTitle:r,getIcon:i,getPinned:u,getProtected:getProtected,getUnique:getUnique}},w=window;chrome.runtime.sendMessage({method:"getSettings"},function(e){var t=e.data;if(void 0!==t){var n=new Tab(location.href,document.title,JSON.parse(t.settings));if(null!==n.getTitle()&&(document.title=n.getTitle()),n.getPinned()===!0&&chrome.runtime.sendMessage({method:"setPinned",tabId:t.tab_id}),null!==n.getIcon()){var l,r,i;l=document.querySelectorAll('head link[rel*="icon"]'),Array.prototype.forEach.call(l,function(e){e.parentNode.removeChild(e)}),r="{default}"===n.getIcon()?chrome.extension.getURL("/img/default_favicon.png"):n.getIcon(),i=document.createElement("link"),i.type="image/x-icon",i.rel="icon",i.href=r,document.getElementsByTagName("head")[0].appendChild(i)}n.getProtected()===!0&&(w.onbeforeunload=function(){return""}),n.getUnique()===!0&&chrome.runtime.sendMessage({method:"setUnique",match:n.getMatch(),tabId:t.tab_id})}});