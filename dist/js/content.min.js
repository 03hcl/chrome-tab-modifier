var w=window;chrome.runtime.sendMessage({method:"getRules"},function(e){if(void 0!==e&&void 0!==e.tab_modifier){for(var t=JSON.parse(e.tab_modifier),n=null,r=0;r<t.rules.length;r++)if(-1!==location.href.indexOf(t.rules[r].url_fragment)){n=t.rules[r];break}if(null!==n){var i,o,a;i=function(e){var t=document.querySelector(e),n="";return null!==t&&(n=t.innerText||t.textContent),n.trim()},o=function(e,t,n){return""===n?e:e.replace(t,n)},a=function(e){var t,r=n.tab.title,a=r.match(/\{([^}]+)}/g);if(null!==a){var l,u;for(t=0;t<a.length;t++)l=a[t].substring(1,a[t].length-1),u=i(l),r=o(r,a[t],u)}if(null!==n.tab.url_matcher)try{if(a=e.match(new RegExp(n.tab.url_matcher),"g"),null!==a)for(t=0;t<a.length;t++)r=o(r,"$"+t,a[t])}catch(c){console.log(c)}return r},null!==n.tab.title&&(document.title=a(location.href));var l,u=!1;if(l=new window.WebKitMutationObserver(function(e){u===!0?u=!1:e.forEach(function(){null!==n.tab.title&&(document.title=a(location.href)),u=!0})}),l.observe(document.querySelector("head > title"),{subtree:!0,characterresponse:!0,childList:!0}),n.tab.pinned===!0&&chrome.runtime.sendMessage({method:"setPinned",tab_id:e.tab_id}),null!==n.tab.icon){var c,d,m;c=document.querySelectorAll('head link[rel*="icon"]'),Array.prototype.forEach.call(c,function(e){e.parentNode.removeChild(e)}),d=-1===n.tab.icon.indexOf("http")?chrome.extension.getURL("/img/"+n.tab.icon):n.tab.icon,m=document.createElement("link"),m.type="image/x-icon",m.rel="icon",m.href=d,document.getElementsByTagName("head")[0].appendChild(m)}n.tab["protected"]===!0&&(w.onbeforeunload=function(){return""}),n.tab.unique===!0&&chrome.runtime.sendMessage({method:"setUnique",url_fragment:n.url_fragment,tab_id:e.tab_id}),n.tab.muted===!0&&chrome.runtime.sendMessage({method:"setMuted",tab_id:e.tab_id})}}});