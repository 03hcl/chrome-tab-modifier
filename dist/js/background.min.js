chrome.runtime.onMessage.addListener(function(e,t,i){switch(e.method){case"getRules":i({tab_id:t.tab.id,tab_modifier:localStorage.tab_modifier});break;case"setUnique":chrome.tabs.get(e.tab_id,function(t){var i;chrome.tabs.query({},function(a){for(var r=0;r<a.length;r++)i=a[r],-1!==i.url.indexOf(e.url_fragment)&&(chrome.tabs.update(i.id,{highlighted:!0}),i.id!==t.id&&chrome.tabs.executeScript(t.id,{code:"window.onbeforeunload = function () {};"},function(){chrome.tabs.remove(t.id)}))})});break;case"setPinned":chrome.tabs.update(e.tab_id,{pinned:!0});break;case"setMuted":chrome.tabs.update(e.tab_id,{muted:!0});break;default:i({})}}),chrome.browserAction.onClicked.addListener(function(e){var t="html/options.min.html",i=chrome.extension.getURL(t),a=!1;chrome.tabs.query({},function(r){for(var o=0;o<r.length;o++)e=r[o],-1!==e.url.indexOf(i)&&(chrome.tabs.get(e.id,function(e){chrome.tabs.highlight({tabs:e.index})}),a=!0);a===!1&&chrome.tabs.create({url:t})})});