chrome.runtime.onMessage.addListener(function(e,t,i){switch(e.method){case"getSettings":i({tab_id:t.tab.id,settings:localStorage.settings});break;case"setUnique":chrome.tabs.get(e.tab_id,function(t){var i=t;chrome.tabs.query({},function(t){var n,o;for(n in t)o=t[n],-1!==o.url.indexOf(e.match)&&(chrome.tabs.update(o.id,{highlighted:!0}),o.id!==i.id&&chrome.tabs.executeScript(i.id,{code:"window.onbeforeunload = function () {};"},function(){chrome.tabs.remove(i.id)}))})});break;case"setPinned":chrome.tabs.update(e.tab_id,{pinned:!0});break;default:i({})}}),chrome.browserAction.onClicked.addListener(function(e){var t="html/options.min.html",i=chrome.extension.getURL(t),n=!1;chrome.tabs.query({},function(e){var o,r;for(o in e)r=e[o],r.url===i&&(chrome.tabs.update(r.id,{highlighted:!0}),n=!0);n===!1&&chrome.tabs.create({url:t})})});