chrome.runtime.onMessage.addListener(function(e,t){switch(e.action){case"setUnique":chrome.tabs.get(t.tab.id,function(t){if(void 0!==t){var n;chrome.tabs.query({},function(i){for(var o=0;o<i.length;o++)n=i[o],-1!==n.url.indexOf(e.url_fragment)&&n.id!==t.id&&chrome.tabs.executeScript(t.id,{code:"window.onbeforeunload = function () {};"},function(){chrome.tabs.remove(t.id)})})}});break;case"setPinned":chrome.tabs.update(t.tab.id,{pinned:!0});break;case"setMuted":chrome.tabs.update(t.tab.id,{muted:!0})}});var openOptionsPage=function(e){var t="html/options.min.html",n=chrome.extension.getURL(t);chrome.tabs.query({url:n},function(n){n.length>0?chrome.tabs.update(n[0].id,{active:!0,highlighted:!0}):chrome.tabs.create({url:void 0!==e?t+"#"+e:t})})};chrome.browserAction.onClicked.addListener(function(){openOptionsPage()}),chrome.runtime.onInstalled.addListener(function(e){switch(e.reason){case"install":openOptionsPage("install");break;case"update":e.previousVersion!==chrome.runtime.getManifest().version&&openOptionsPage("update/"+chrome.runtime.getManifest().version)}});