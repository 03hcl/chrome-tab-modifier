var app=angular.module("TabModifier",["ngRoute","ngAnimate","ngMaterial"]);app.config(["$routeProvider","$compileProvider","$mdIconProvider","$mdThemingProvider",function(t,e,o,n){e.aHrefSanitizationWhitelist(/^\s*(blob|http|https|chrome-extension):/),o.icon("information-outline","/icons/information-outline.svg").icon("file-outline","/icons/file-outline.svg").icon("options-vertical","/icons/dots-vertical.svg").icon("close","/icons/close.svg").icon("plus","/icons/plus.svg").icon("image","/icons/image.svg").icon("save","/icons/content-save.svg").icon("tab","/icons/checkbox-multiple-marked-outline.svg").icon("list","/icons/format-list-bulleted.svg").icon("tab","/icons/tab.svg").icon("list-plus","/icons/playlist-plus.svg").icon("clear","/icons/eraser.svg").icon("settings","/icons/settings.svg").icon("duplicate","/icons/content-copy.svg").icon("delete","/icons/delete.svg").icon("edit","/icons/pencil.svg").icon("google-chrome","/icons/google-chrome.svg").icon("github-circle","/icons/github-circle.svg").icon("help","/icons/help-circle.svg"),n.theme("default").primaryPalette("blue-grey",{"default":"500"}).accentPalette("pink",{"default":"400"}).warnPalette("red",{"default":"500"});var l={"/":{templateUrl:"/html/tab_rules.min.html",controller:"TabRulesController"},"/settings":{templateUrl:"/html/settings.min.html",controller:"SettingsController"},"/help":{templateUrl:"/html/help.min.html",controller:"HelpController"}};for(var i in l)l.hasOwnProperty(i)&&t.when(i,l[i])}]),app.run(["$rootScope","$location",function(t,e){t.location=e}]),app.controller("HelpController",function(){}),app.controller("SettingsController",["$scope","TabModifier",function(t,e){var o=new e;o.getLocalData(),t.json_url=o["export"](),t["import"]=function(){}}]),app.controller("TabRulesController",["$scope","$mdDialog","$mdMedia","Rule","TabModifier",function(t,e,o,n,l){var i=new l;i.checkOldSettings(),i.getLocalData(),t.tab_modifier=i,t.showForm=function(t,l){var r=void 0===l?null:i.rules.indexOf(l);e.show({controller:"FormModalController",templateUrl:"../html/form.min.html",targetEvent:t,clickOutsideToClose:!0,fullscreen:o("md"),resolve:{rule:function(){return null===r?new n:l}}}).then(function(t){i.save(t,r)})},t.duplicate=function(t){i.save(new n(t))},t["delete"]=function(t,o){var n=e.confirm().clickOutsideToClose(!1).title("Delete rule").textContent("Do you really want to delete this rule?").ariaLabel("Delete rule").targetEvent(t).ok("Delete").cancel("Cancel");e.show(n).then(function(){i.removeRule(o)})}}]),app.controller("FormModalController",["$scope","$mdDialog","rule",function(t,e,o){t.rule=o,t.$watch("rule.url_fragment",function(){(""===o.url_fragment||void 0===o.url_fragment)&&o.setModel({url_fragment:null})}),t.$watch("rule.tab.title",function(){(""===o.tab.title||void 0===o.tab.title)&&(o.tab.title=null)}),t.$watch("rule.tab.icon",function(){(""===o.tab.icon||void 0===o.tab.icon)&&(o.tab.icon=null)}),t.$watch("rule.tab.url_matcher",function(){(""===o.tab.url_matcher||void 0===o.tab.url_matcher)&&(o.tab.url_matcher=null)}),t.closeForm=function(){e.cancel()},t.save=function(t){e.hide(t)}}]),app.factory("Rule",function(){var t=function(t){this.name=null,this.url_fragment=null,this.tab={title:null,icon:null,pinned:!1,"protected":!1,unique:!1,muted:!1,url_matcher:null},angular.extend(this,t)};return t.prototype.setModel=function(t){angular.extend(this,t)},t}),app.factory("TabModifier",["Rule",function(t){var e=function(t){this.rules=[],angular.extend(this,t)};return e.prototype.setModel=function(t){angular.extend(this,t)},e.prototype.addRule=function(t){this.rules.push(t)},e.prototype.removeRule=function(t){this.rules.splice(this.rules.indexOf(t),1),this.setLocalData()},e.prototype.save=function(t,e){null===e||void 0===e?this.addRule(t):this.rules[e]=t,this.setLocalData()},e.prototype.build=function(e){var o=this;this.rules=[],angular.forEach(e.rules,function(e){o.addRule(new t(e))})},e.prototype.getLocalData=function(){void 0!==localStorage.tab_modifier&&this.build(JSON.parse(localStorage.tab_modifier))},e.prototype.setLocalData=function(){localStorage.tab_modifier=JSON.stringify(this)},e.prototype.checkOldSettings=function(){var e,o,n=this,l=0;if(void 0!==localStorage.settings){this.rules=[],e=JSON.parse(localStorage.settings);for(var i in e)e.hasOwnProperty(i)&&(o=new t({name:"Rule "+(l+1),url_fragment:i,tab:{title:e[i].title||null,icon:e[i].icon||null,pinned:e[i].pinned||!1,"protected":e[i]["protected"]||!1,unique:e[i].unique||!1,muted:e[i].muted||!1,url_matcher:e[i].url_matcher||null}}),n.addRule(o)),l++;this.setLocalData(),localStorage.removeItem("settings")}},e.prototype["import"]=function(){},e.prototype["export"]=function(){var t=new Blob([JSON.stringify(this,null,4)],{type:"text/plain"});return(window.URL||window.webkitURL).createObjectURL(t)},e}]);